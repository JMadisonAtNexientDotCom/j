<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TRIVIA CHALLENGE FLOW -Test/Debug</title>
		
		<!-- ABOUT: Tests the basic flow of getting TriviaBundle from the server -->
		<!-- And then re-submitting the Quar (slate container) section of the    -->
		<!-- Bundle for grading.                                                 -->
		<!-- Then allows you to pull down the last submitted Quar to verify      -->
		<!-- That you were able to post information to server.                   -->
		<!-- NEXT on my todo list: -->
		<!-- We need a way to: -->
		<!-- 1: Give user an initial password. -->
		<!-- 2: Trial tokens that are associated with a specific user and test.  -->
		
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
		<!-- BEFORE BOOTSTRAP INCLUDE: Bootstrap requires JQuery Library. -->
		<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
		<!-- Bootstrap: .js and .css respectively.                                   -->
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
		
		
		<!-- Enable spinners for ASYNC operations. -->
		<!-- SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS -->
		<!--
		<script src="../jsLib/node_modules/angular-spinners/src/spinner-service.js"></script>
		<script src="../jsLib/node_modules/angular-spinners/src/spinner-directive.js"></script>
		<script src="../jsLib/node_modules/angular-spinners/dist/angular-spinners.js"></script>
		<LINK REL=StyleSheet HREF="../jsLib/css/components/loading_spinner.css" TYPE="text/css">
		-->
		<!-- SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS -->

  </head>
<!-- AUTHOR: JMadison.  ON:20##.##.##_####AMPM                               -->
<!-- TABSIZE: 2 Spaces.                                                      -->
<!-- This header belongs BELOW the <head></head> declaration.                -->
<!--   10|       20|       30|       40|       50|       60|       70|       -->
<!--5678901234567890123456789012345678901234567890123456789012345678901234567-->

  <body>
    
		<div data-ng-app="myApp" data-ng-controller="myCtrl" data-ng-init="VI();" >

			<button data-ng-click="getTriviaBundle();">Get Trivia Bundle!</button>
			<textarea wrap="off" readonly>{{JSON_AS_TEXT_trivia_bundle}}</textarea>
			<textarea wrap="off" readonly>{{JSON_AS_TEXT_quar}}</textarea>
			<br/>
			<button data-ng-click="postQuarForGrading();">Grade The Slates</button>
			<textarea wrap="off" readonly>{{JSON_AS_TEXT_score}}</textarea>
			<br/>
			<button data-ng-click="getLastPostedQuar();">Get Last Posted Quar</button>
			<textarea wrap="off" readonly>{{JSON_AS_TEXT_getLastPostedQuar}}</textarea>
			<p> NOTE: I have noticed that, if the server hasn't been active for a few
			    hours, the first API call can result in an internal server error.
					Something to take note of. As a test that fails may pass the second
				  time.
			</p>
		</div>
		
		<script>
		var app = angular.module('myApp', []);
		app.controller('myCtrl', function($scope, $http) {
				
				//variable initialization:
				$scope.VI = function(){
					$scope.appInitialized = true;
					$scope.INSTJSON_trivia_bundle = {};
					$scope.INSTJSON_quar          = {};
					$scope.INSTJSON_score         = {};
					$scope.INSTJSON_getLastPostedQuar = {};
					
					$scope.JSON_AS_TEXT_trivia_bundle = "";
					$scope.JSON_AS_TEXT_quar          = "";
					$scope.JSON_AS_TEXT_score         = "";
					$scope.JSON_AS_TEXT_getLastPostedQuar = {};
				}
				
				//SERVICE CALLS:
				//SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
				
				//Trigger HTTP request to get trivia bundle:
				$scope.getTriviaBundle = function(){
				  $scope.INSTJSON_trivia_bundle = { "loading":"loading" };
					$scope.JSON_AS_TEXT_trivia_bundle = JSON.stringify($scope.INSTJSON_trivia_bundle);
					serviceURL01 = "http://j1clone01-madnamespace.rhcloud.com/api/RiddleRhymeRestService/getRandomTriviaBundle";
					//spinnerService.show('html5spinner'); //<--where is ref to spinnerService?
					$http.get(serviceURL01).success( onResponded_getTriviaBundle );
				};
				
				//Trigger HTTP POST request to grade slates inside the quar:
				$scope.postQuarForGrading = function(){
					$scope.INSTJSON_score = { "loading":"loading" };
					$scope.JSON_AS_TEXT_score = JSON.stringify($scope.INSTJSON_score);
					
					serviceURL = "http://j1clone01-madnamespace.rhcloud.com/api/RiddleRhymeRestService/postQuarForGrading";
					//spinnerService.show('html5spinner'); //<--where is ref to spinnerService?
					$http.post(serviceURL, $scope.INSTJSON_trivia_bundle.quar).success( onResponded_postQuarForGrading );
				};
				
				$scope.getLastPostedQuar = function(){
					$scope.INSTJSON_getLastPostedQuar = { "loading":"loading" };
					$scope.JSON_AS_TEXT_getLastPostedQuar = JSON.stringify($scope.INSTJSON_getLastPostedQuar);
					
					serviceURL = "http://j1clone01-madnamespace.rhcloud.com/api/RiddleRhymeRestService/getLastPostedQuar";
					//spinnerService.show('html5spinner'); //<--where is ref to spinnerService?
					$http.get(serviceURL).success( onResponded_getLastPostedQuar);
				};//FUNC::END
				
				//SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
				
				//RESPONSE CALBACKS:
				//RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
				function onResponded_getTriviaBundle(response){
				
				  //The bundle:
					$scope.INSTJSON_trivia_bundle = response;
					$scope.JSON_AS_TEXT_trivia_bundle = JSON.stringify($scope.INSTJSON_trivia_bundle,null,2);
					
					//The extracted quar:
					$scope.INSTJSON_quar = $scope.INSTJSON_trivia_bundle.quar;
					$scope.JSON_AS_TEXT_quar = JSON.stringify($scope.INSTJSON_quar,null,2);
					
					//spinnerService.hide('html5spinner');
				}//FUNC::END
				
				//function onResponded_postQuarForGrading(data, status, headers, config){
				function onResponded_postQuarForGrading(data){
					$scope.JSON_AS_TEXT_score = "POSTED.";
					//spinnerService.hide('html5spinner');
				}//FUNC::END
				
				//Display what was posted to server for confirmation:
				function onResponded_getLastPostedQuar(data){
					$scope.INSTJSON_getLastPostedQuar = data;
					$scope.JSON_AS_TEXT_getLastPostedQuar = JSON.stringify($scope.INSTJSON_getLastPostedQuar,null,2);
					//spinnerService.hide('html5spinner');
				}//FUNC::END
				
				//RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
				
				
		});
		</script>
		
  </body>
</html>
<!--   10|       20|       30|       40|       50|       60|       70|       -->
<!--5678901234567890123456789012345678901234567890123456789012345678901234567-->